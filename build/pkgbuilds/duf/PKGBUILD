# Maintainer: neg-serg <neg-serg@example.com>
pkgname=duf
pkgver=0.8.1
pkgrel=2
pkgdesc='Disk Usage/Free Utility (neg-serg fork with --style plain support)'
arch=('x86_64')
url='https://github.com/neg-serg/duf'
license=('MIT')
depends=()
makedepends=('go' 'git')
conflicts=('duf')
provides=('duf')
source=("${pkgname}-${pkgver}.tar.gz::${url}/archive/master.tar.gz")
sha256sums=('SKIP')

build() {
    cd "${pkgname}-master"
    export CGO_CPPFLAGS="${CPPFLAGS}"
    export CGO_CFLAGS="${CFLAGS}"
    export CGO_CXXFLAGS="${CXXFLAGS}"
    export CGO_LDFLAGS="${LDFLAGS}"
    export GOFLAGS="-buildmode=pie -trimpath -mod=readonly -modcacherw"
    go build -ldflags "-linkmode=external -s -w" -o duf
}

package() {
    cd "${pkgname}-master"
    install -Dm755 duf "${pkgdir}/usr/bin/duf"
    install -Dm644 LICENSE "${pkgdir}/usr/share/licenses/${pkgname}/LICENSE"
}
